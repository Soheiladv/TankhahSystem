[2025-07-15 10:46:21] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'tankhah_report_21_no_filters', 'free_budget_72'}
[2025-07-15 11:11:01] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'free_budget_72', 'tankhah_report_21_no_filters'}
[2025-07-15 11:14:47] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'free_budget_72', 'tankhah_report_21_no_filters'}
[2025-07-15 11:14:58] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'free_budget_72', 'tankhah_report_21_no_filters'}
[2025-07-15 11:52:38] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 3 records
[2025-07-15 11:52:38] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD396E9D0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/15 - 2,500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/15 - 2,500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x000001BAD3661BE0>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('1500000000.00'), 'total_allocated': Decimal('3500000000.00'), 'allocated_percentage': Decimal('70.00'), 'remaining_percentage': Decimal('30.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': '', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-15 11:52:52] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:301] get_context_data - BudgetPeriodListView context calculated totals: sum=5000000000, remaining=1500000000.00
[2025-07-15 11:52:52] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:302] get_context_data - BudgetPeriodListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD3A059D0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'view': <budgets.BudgetPeriod.views_BudgetPeriod.BudgetPeriodListView object at 0x000001BAD3661FD0>, 'total_sum': Decimal('5000000000'), 'total_remaining': Decimal('1500000000.00'), 'query': '', 'status': '', 'date_from': '', 'date_to': '', 'status_summary': {'active': 1, 'locked': 0, 'completed': 0, 'total': 1}, 'result_count': 1}
[2025-07-15 11:52:55] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 3 records
[2025-07-15 11:52:55] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD0F1F4D0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/15 - 2,500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/15 - 2,500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x000001BAD3CE2490>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('1500000000.00'), 'total_allocated': Decimal('3500000000.00'), 'allocated_percentage': Decimal('70.00'), 'remaining_percentage': Decimal('30.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': 'کلان بودجه شش ماهه 1404', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-15 11:53:00] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:375] get_context_data - BudgetAllocationDetailView context: {'object': <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/15 - 2,500,000,000 ریال>, 'budget_allocation': <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/15 - 2,500,000,000 ریال>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationDetailView object at 0x000001BAD373F770>, 'budget_details': {'total_budget': Decimal('0'), 'total_allocated': Decimal('0'), 'remaining_budget': Decimal('0'), 'project_count': 0, 'allocation_count': 0, 'last_update': None, 'status_message': 'نامشخص'}}
[2025-07-15 11:53:06] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:498] __init__ - Set initial allocation_date from instance: 1404/04/15
[2025-07-15 11:53:06] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:518] __init__ - Organization queryset set for active, allocatable orgs.
[2025-07-15 11:53:13] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:498] __init__ - Set initial allocation_date from instance: 1404/04/15
[2025-07-15 11:53:13] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:518] __init__ - Organization queryset set for active, allocatable orgs.
[2025-07-15 11:53:13] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:602] clean - Converted percent to amount: 125000000000000000.00
[2025-07-15 11:53:13] DEBUG [budgets.models:292] clean - Cleaning BudgetAllocation: allocated_amount=125000000000000000.00, allocation_type=percent
[2025-07-15 11:53:13] ERROR [budgets.BudgetAllocation.forms_BudgetAllocation:650] clean - Error in BudgetAllocationForm.clean: ['مبلغ تخصیص (125,000,000,000,000,000 ریال) بیشتر از باقی\u200cمانده دوره بودجه (4,000,000,000 ریال) است.']
[2025-07-15 11:53:13] DEBUG [budgets.models:292] clean - Cleaning BudgetAllocation: allocated_amount=125000000000000000.00, allocation_type=percent
[2025-07-15 11:53:18] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:301] get_context_data - BudgetPeriodListView context calculated totals: sum=5000000000, remaining=1500000000.00
[2025-07-15 11:53:18] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:302] get_context_data - BudgetPeriodListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD448C350>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'view': <budgets.BudgetPeriod.views_BudgetPeriod.BudgetPeriodListView object at 0x000001BAD3CE2D50>, 'total_sum': Decimal('5000000000'), 'total_remaining': Decimal('1500000000.00'), 'query': '', 'status': '', 'date_from': '', 'date_to': '', 'status_summary': {'active': 1, 'locked': 0, 'completed': 0, 'total': 1}, 'result_count': 1}
[2025-07-15 11:53:20] INFO [budgets.BudgetAllocation.views_BudgetAllocation:540] dispatch - Starting dispatch in BudgetAllocationCreateView for user: admin
[2025-07-15 11:53:20] INFO [budgets.BudgetAllocation.views_BudgetAllocation:465] get_initial - Set initial budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-15 11:53:20] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: 21
[2025-07-15 11:53:20] INFO [budgets.BudgetAllocation.views_BudgetAllocation:478] _get_budget_period - Retrieved budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-15 11:53:20] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:504] __init__ - Set default allocation_date: 1404/04/24
[2025-07-15 11:53:20] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:518] __init__ - Organization queryset set for active, allocatable orgs.
[2025-07-15 11:53:20] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: 21
[2025-07-15 11:53:20] INFO [budgets.BudgetAllocation.views_BudgetAllocation:478] _get_budget_period - Retrieved budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-15 11:53:20] INFO [budgets.BudgetAllocation.views_BudgetAllocation:508] get_context_data - Budget period data: total=5000000000, remaining=1500000000.00
[2025-07-15 11:53:20] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:522] get_context_data - Loaded 5 projects
[2025-07-15 11:53:23] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 3 records
[2025-07-15 11:53:23] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD449FED0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/15 - 2,500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/15 - 2,500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x000001BAD3CE2AD0>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('1500000000.00'), 'total_allocated': Decimal('3500000000.00'), 'allocated_percentage': Decimal('70.00'), 'remaining_percentage': Decimal('30.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': 'کلان بودجه شش ماهه 1404', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-15 11:53:27] DEBUG [budgets.signals:55] invalidate_transaction_cache - Invalidated cache keys after BudgetTransaction change: {'project_remaining_budget_10', 'free_budget_71', 'returned_budgets_21_all_no_filters', 'budget_transfers_21_no_filters'}
[2025-07-15 11:53:27] DEBUG [budgets.signals:23] update_total_allocated - Updated total_allocated=1000000000.00 for BudgetPeriod 21
[2025-07-15 11:53:27] DEBUG [budgets.signals:72] invalidate_allocation_cache - Invalidated cache keys after BudgetAllocation change: {'tankhah_report_21_no_filters', 'project_remaining_budget_10', 'free_budget_71', 'budget_transfers_21_no_filters'}
[2025-07-15 11:53:27] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 2 records
[2025-07-15 11:53:27] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD449FCD0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x000001BAD3F4D480>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('4000000000.00'), 'total_allocated': Decimal('1000000000.00'), 'allocated_percentage': Decimal('20.00'), 'remaining_percentage': Decimal('80.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': '', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-15 11:53:35] INFO [budgets.BudgetAllocation.views_BudgetAllocation:540] dispatch - Starting dispatch in BudgetAllocationCreateView for user: admin
[2025-07-15 11:53:35] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: None
[2025-07-15 11:53:35] WARNING [budgets.BudgetAllocation.views_BudgetAllocation:474] _get_budget_period - No budget_period_id provided
[2025-07-15 11:53:35] WARNING [budgets.BudgetAllocation.views_BudgetAllocation:531] get_form_kwargs - No valid budget period for form
[2025-07-15 11:53:35] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:504] __init__ - Set default allocation_date: 1404/04/24
[2025-07-15 11:53:35] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:518] __init__ - Organization queryset set for active, allocatable orgs.
[2025-07-15 11:53:35] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: None
[2025-07-15 11:53:35] WARNING [budgets.BudgetAllocation.views_BudgetAllocation:474] _get_budget_period - No budget_period_id provided
[2025-07-15 11:53:35] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:522] get_context_data - Loaded 5 projects
[2025-07-15 11:53:37] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:301] get_context_data - BudgetPeriodListView context calculated totals: sum=5000000000, remaining=4000000000.00
[2025-07-15 11:53:37] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:302] get_context_data - BudgetPeriodListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD449E550>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'view': <budgets.BudgetPeriod.views_BudgetPeriod.BudgetPeriodListView object at 0x000001BAD3CE2D50>, 'total_sum': Decimal('5000000000'), 'total_remaining': Decimal('4000000000.00'), 'query': '', 'status': '', 'date_from': '', 'date_to': '', 'status_summary': {'active': 1, 'locked': 0, 'completed': 0, 'total': 1}, 'result_count': 1}
[2025-07-15 11:53:39] INFO [budgets.BudgetAllocation.views_BudgetAllocation:540] dispatch - Starting dispatch in BudgetAllocationCreateView for user: admin
[2025-07-15 11:53:39] INFO [budgets.BudgetAllocation.views_BudgetAllocation:465] get_initial - Set initial budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-15 11:53:39] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: 21
[2025-07-15 11:53:39] INFO [budgets.BudgetAllocation.views_BudgetAllocation:478] _get_budget_period - Retrieved budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-15 11:53:39] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:504] __init__ - Set default allocation_date: 1404/04/24
[2025-07-15 11:53:39] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:518] __init__ - Organization queryset set for active, allocatable orgs.
[2025-07-15 11:53:39] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: 21
[2025-07-15 11:53:39] INFO [budgets.BudgetAllocation.views_BudgetAllocation:478] _get_budget_period - Retrieved budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-15 11:53:39] INFO [budgets.BudgetAllocation.views_BudgetAllocation:508] get_context_data - Budget period data: total=5000000000, remaining=4000000000.00
[2025-07-15 11:53:39] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:522] get_context_data - Loaded 5 projects
[2025-07-15 11:54:15] INFO [budgets.BudgetAllocation.views_BudgetAllocation:540] dispatch - Starting dispatch in BudgetAllocationCreateView for user: admin
[2025-07-15 11:54:15] INFO [budgets.BudgetAllocation.views_BudgetAllocation:465] get_initial - Set initial budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-15 11:54:15] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: 21
[2025-07-15 11:54:15] INFO [budgets.BudgetAllocation.views_BudgetAllocation:478] _get_budget_period - Retrieved budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-15 11:54:15] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:504] __init__ - Set default allocation_date: 1404/04/24
[2025-07-15 11:54:15] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:518] __init__ - Organization queryset set for active, allocatable orgs.
[2025-07-15 11:54:15] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:602] clean - Converted percent to amount: 2000000000.0
[2025-07-15 11:54:15] DEBUG [budgets.models:292] clean - Cleaning BudgetAllocation: allocated_amount=2000000000.0, allocation_type=percent
[2025-07-15 11:54:15] DEBUG [budgets.models:340] clean - Clean validation passed (Model IS : BudgetsAllocations )
[2025-07-15 11:54:15] DEBUG [budgets.models:292] clean - Cleaning BudgetAllocation: allocated_amount=2000000000.0, allocation_type=percent
[2025-07-15 11:54:15] DEBUG [budgets.models:340] clean - Clean validation passed (Model IS : BudgetsAllocations )
[2025-07-15 11:54:15] INFO [budgets.BudgetAllocation.views_BudgetAllocation:544] form_valid - Form valid for BudgetAllocation, saving...
[2025-07-15 11:54:15] DEBUG [budgets.models:418] save - Starting save for BudgetAllocation (pk=None, allocated_amount=2000000000.0)
[2025-07-15 11:54:15] DEBUG [budgets.models:292] clean - Cleaning BudgetAllocation: allocated_amount=2000000000.0, allocation_type=percent
[2025-07-15 11:54:15] DEBUG [budgets.models:340] clean - Clean validation passed (Model IS : BudgetsAllocations )
[2025-07-15 11:54:15] ERROR [budgets.models:414] update_lock_status - Error in update_lock_status for BudgetAllocation unsaved: Model instances passed to related filters must be saved.
[2025-07-15 11:54:15] DEBUG [budgets.signals:23] update_total_allocated - Updated total_allocated=3000000000.00 for BudgetPeriod 21
[2025-07-15 11:54:15] DEBUG [budgets.signals:72] invalidate_allocation_cache - Invalidated cache keys after BudgetAllocation change: {'tankhah_report_21_no_filters', 'free_budget_74', 'budget_transfers_21_no_filters', 'project_remaining_budget_11'}
[2025-07-15 11:54:15] INFO [budgets.models:426] save - BudgetAllocation saved with ID: 74
[2025-07-15 11:54:15] DEBUG [budgets.models:428] save - Allocation status: normal, message: وضعیت عادی
[2025-07-15 11:54:15] DEBUG [budgets.models:97] save - Starting save for BudgetPeriod (pk=21)
[2025-07-15 11:54:15] INFO [budgets.models:102] save - BudgetPeriod saved with ID: 21
[2025-07-15 11:54:15] DEBUG [budgets.models:142] check_budget_status_no_save - check_budget_status_no_save: obj=کلان بودجه شش ماهه 1404 (HQ_ITDC), result=('normal', 'وضعیت عادی')
[2025-07-15 11:54:15] DEBUG [budgets.models:171] update_lock_status - Updated lock status for BudgetPeriod 21: is_active=True, is_completed=False
[2025-07-15 11:54:15] DEBUG [budgets.models:142] check_budget_status_no_save - check_budget_status_no_save: obj=کلان بودجه شش ماهه 1404 (HQ_ITDC), result=('normal', 'وضعیت عادی')
[2025-07-15 11:54:15] INFO [budgets.BudgetAllocation.views_BudgetAllocation:555] form_valid - BudgetAllocation created with ID: 74
[2025-07-15 11:54:15] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 3 records
[2025-07-15 11:54:15] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD4525750>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x000001BAD3F4D5B0>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('2000000000.00'), 'total_allocated': Decimal('3000000000.00'), 'allocated_percentage': Decimal('60.00'), 'remaining_percentage': Decimal('40.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': '', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-15 11:54:22] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:301] get_context_data - BudgetPeriodListView context calculated totals: sum=5000000000, remaining=2000000000.00
[2025-07-15 11:54:22] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:302] get_context_data - BudgetPeriodListView context: {'paginator': <django.core.paginator.Paginator object at 0x000001BAD450D4D0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'view': <budgets.BudgetPeriod.views_BudgetPeriod.BudgetPeriodListView object at 0x000001BAD3F4DBA0>, 'total_sum': Decimal('5000000000'), 'total_remaining': Decimal('2000000000.00'), 'query': '', 'status': '', 'date_from': '', 'date_to': '', 'status_summary': {'active': 1, 'locked': 0, 'completed': 0, 'total': 1}, 'result_count': 1}
[2025-07-15 11:54:59] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'tankhah_report_21_no_filters', 'free_budget_74'}
[2025-07-15 11:57:44] DEBUG [budgets.models:549] save - Starting save for BudgetTransaction: amount=200000000, type=CONSUMPTION, allocation ID=74
[2025-07-15 11:57:44] DEBUG [budgets.models:538] clean - Cleaning BudgetTransaction: amount=200000000, type=CONSUMPTION, allocation ID=74
[2025-07-15 11:57:44] INFO [budgets.models:545] clean - BudgetTransaction validated successfully for allocation ID: 74
[2025-07-15 11:57:44] DEBUG [budgets.signals:31] update_remaining_amount - BudgetTransaction TX-FACTOR-NEW-6-1752568064.557149 created. Invalidating cache for allocation 74
[2025-07-15 11:57:44] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'tankhah_report_21_no_filters', 'free_budget_74'}
[2025-07-15 11:57:44] DEBUG [budgets.signals:37] update_remaining_amount - Updated remaining_budget for Tankhah 4
[2025-07-15 11:57:44] DEBUG [budgets.signals:55] invalidate_transaction_cache - Invalidated cache keys after BudgetTransaction change: {'free_budget_74', 'budget_transfers_21_no_filters', 'returned_budgets_21_all_no_filters', 'project_remaining_budget_11'}
[2025-07-15 11:57:44] INFO [budgets.models:559] save - BudgetTransaction saved with ID: 66
[2025-07-18 20:16:43] INFO [budgets.PaymentOrder.view_PaymentOrder:657] get_context_data - Context prepared for user admin, 0 payment orders, 0 approved factors
[2025-07-18 20:22:17] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'tankhah_report_21_no_filters', 'free_budget_72'}
[2025-07-18 20:22:51] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'tankhah_report_21_no_filters', 'free_budget_72'}
[2025-07-18 20:22:58] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'tankhah_report_21_no_filters', 'free_budget_72'}
[2025-07-18 20:23:20] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'tankhah_report_21_no_filters', 'free_budget_72'}
[2025-07-18 22:33:27] INFO [budgets.PaymentOrder.view_PaymentOrder:657] get_context_data - Context prepared for user admin, 0 payment orders, 0 approved factors
[2025-07-19 12:49:38] INFO [budgets.PaymentOrder.view_PaymentOrder:657] get_context_data - Context prepared for user admin, 0 payment orders, 0 approved factors
[2025-07-19 14:22:35] INFO [budgets.PaymentOrder.view_PaymentOrder:657] get_context_data - Context prepared for user admin, 0 payment orders, 0 approved factors
[2025-07-19 14:54:21] INFO [budgets.PaymentOrder.view_PaymentOrder:657] get_context_data - Context prepared for user admin, 0 payment orders, 0 approved factors
[2025-07-19 15:54:22] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:301] get_context_data - BudgetPeriodListView context calculated totals: sum=5000000000, remaining=2000000000.00
[2025-07-19 15:54:22] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:302] get_context_data - BudgetPeriodListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEBE81950>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'view': <budgets.BudgetPeriod.views_BudgetPeriod.BudgetPeriodListView object at 0x0000028EEE909A90>, 'total_sum': Decimal('5000000000'), 'total_remaining': Decimal('2000000000.00'), 'query': '', 'status': '', 'date_from': '', 'date_to': '', 'status_summary': {'active': 1, 'locked': 0, 'completed': 0, 'total': 1}, 'result_count': 1}
[2025-07-19 15:54:26] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 3 records
[2025-07-19 15:54:26] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEEA7B7A0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x0000028EEE90BB60>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('2000000000.00'), 'total_allocated': Decimal('3000000000.00'), 'allocated_percentage': Decimal('60.00'), 'remaining_percentage': Decimal('40.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': 'کلان بودجه شش ماهه 1404', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-19 15:54:37] INFO [budgets.BudgetAllocation.views_BudgetAllocation:540] dispatch - Starting dispatch in BudgetAllocationCreateView for user: admin
[2025-07-19 15:54:37] INFO [budgets.BudgetAllocation.views_BudgetAllocation:465] get_initial - Set initial budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-19 15:54:37] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: 21
[2025-07-19 15:54:37] INFO [budgets.BudgetAllocation.views_BudgetAllocation:478] _get_budget_period - Retrieved budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-19 15:54:37] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:504] __init__ - Set default allocation_date: 1404/04/28
[2025-07-19 15:54:37] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:518] __init__ - Organization queryset set for active, allocatable orgs.
[2025-07-19 15:54:37] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: 21
[2025-07-19 15:54:37] INFO [budgets.BudgetAllocation.views_BudgetAllocation:478] _get_budget_period - Retrieved budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-19 15:54:37] INFO [budgets.BudgetAllocation.views_BudgetAllocation:508] get_context_data - Budget period data: total=5000000000, remaining=2000000000.00
[2025-07-19 15:54:37] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:522] get_context_data - Loaded 5 projects
[2025-07-19 15:55:12] INFO [budgets.BudgetAllocation.views_BudgetAllocation:540] dispatch - Starting dispatch in BudgetAllocationCreateView for user: admin
[2025-07-19 15:55:12] INFO [budgets.BudgetAllocation.views_BudgetAllocation:465] get_initial - Set initial budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-19 15:55:12] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:472] _get_budget_period - Getting budget_period with ID: 21
[2025-07-19 15:55:12] INFO [budgets.BudgetAllocation.views_BudgetAllocation:478] _get_budget_period - Retrieved budget_period: ID=21, name=کلان بودجه شش ماهه 1404
[2025-07-19 15:55:12] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:504] __init__ - Set default allocation_date: 1404/04/28
[2025-07-19 15:55:12] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:518] __init__ - Organization queryset set for active, allocatable orgs.
[2025-07-19 15:55:12] DEBUG [budgets.BudgetAllocation.forms_BudgetAllocation:602] clean - Converted percent to amount: 500000000.0
[2025-07-19 15:55:12] DEBUG [budgets.models:292] clean - Cleaning BudgetAllocation: allocated_amount=500000000.0, allocation_type=percent
[2025-07-19 15:55:12] DEBUG [budgets.models:340] clean - Clean validation passed (Model IS : BudgetsAllocations )
[2025-07-19 15:55:12] DEBUG [budgets.models:292] clean - Cleaning BudgetAllocation: allocated_amount=500000000.0, allocation_type=percent
[2025-07-19 15:55:12] DEBUG [budgets.models:340] clean - Clean validation passed (Model IS : BudgetsAllocations )
[2025-07-19 15:55:12] INFO [budgets.BudgetAllocation.views_BudgetAllocation:544] form_valid - Form valid for BudgetAllocation, saving...
[2025-07-19 15:55:12] DEBUG [budgets.models:418] save - Starting save for BudgetAllocation (pk=None, allocated_amount=500000000.0)
[2025-07-19 15:55:12] DEBUG [budgets.models:292] clean - Cleaning BudgetAllocation: allocated_amount=500000000.0, allocation_type=percent
[2025-07-19 15:55:12] DEBUG [budgets.models:340] clean - Clean validation passed (Model IS : BudgetsAllocations )
[2025-07-19 15:55:12] ERROR [budgets.models:414] update_lock_status - Error in update_lock_status for BudgetAllocation unsaved: Model instances passed to related filters must be saved.
[2025-07-19 15:55:12] DEBUG [budgets.signals:23] update_total_allocated - Updated total_allocated=3500000000.00 for BudgetPeriod 21
[2025-07-19 15:55:12] DEBUG [budgets.signals:72] invalidate_allocation_cache - Invalidated cache keys after BudgetAllocation change: {'budget_transfers_21_no_filters', 'free_budget_75', 'tankhah_report_21_no_filters', 'project_remaining_budget_7'}
[2025-07-19 15:55:12] INFO [budgets.models:426] save - BudgetAllocation saved with ID: 75
[2025-07-19 15:55:12] DEBUG [budgets.models:428] save - Allocation status: normal, message: وضعیت عادی
[2025-07-19 15:55:12] DEBUG [budgets.models:97] save - Starting save for BudgetPeriod (pk=21)
[2025-07-19 15:55:12] INFO [budgets.models:102] save - BudgetPeriod saved with ID: 21
[2025-07-19 15:55:12] DEBUG [budgets.models:142] check_budget_status_no_save - check_budget_status_no_save: obj=کلان بودجه شش ماهه 1404 (HQ_ITDC), result=('normal', 'وضعیت عادی')
[2025-07-19 15:55:12] DEBUG [budgets.models:171] update_lock_status - Updated lock status for BudgetPeriod 21: is_active=True, is_completed=False
[2025-07-19 15:55:12] DEBUG [budgets.models:142] check_budget_status_no_save - check_budget_status_no_save: obj=کلان بودجه شش ماهه 1404 (HQ_ITDC), result=('normal', 'وضعیت عادی')
[2025-07-19 15:55:12] INFO [budgets.BudgetAllocation.views_BudgetAllocation:555] form_valid - BudgetAllocation created with ID: 75
[2025-07-19 15:55:13] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 4 records
[2025-07-19 15:55:13] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEEA794F0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: دفتر مرکزی شرکت توسعه گردشگری ایران - بازسازی و مرمت - 1404/04/28 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: دفتر مرکزی شرکت توسعه گردشگری ایران - بازسازی و مرمت - 1404/04/28 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x0000028EEE6AC7D0>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('1500000000.00'), 'total_allocated': Decimal('3500000000.00'), 'allocated_percentage': Decimal('70.00'), 'remaining_percentage': Decimal('30.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': '', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-19 15:55:23] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:301] get_context_data - BudgetPeriodListView context calculated totals: sum=5000000000, remaining=1500000000.00
[2025-07-19 15:55:23] DEBUG [budgets.BudgetPeriod.views_BudgetPeriod:302] get_context_data - BudgetPeriodListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEF04BBD0>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'view': <budgets.BudgetPeriod.views_BudgetPeriod.BudgetPeriodListView object at 0x0000028EEE6AE990>, 'total_sum': Decimal('5000000000'), 'total_remaining': Decimal('1500000000.00'), 'query': '', 'status': '', 'date_from': '', 'date_to': '', 'status_summary': {'active': 1, 'locked': 0, 'completed': 0, 'total': 1}, 'result_count': 1}
[2025-07-19 15:55:27] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 4 records
[2025-07-19 15:55:27] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEF04B850>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: دفتر مرکزی شرکت توسعه گردشگری ایران - بازسازی و مرمت - 1404/04/28 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: دفتر مرکزی شرکت توسعه گردشگری ایران - بازسازی و مرمت - 1404/04/28 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x0000028EEE6AC550>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('1500000000.00'), 'total_allocated': Decimal('3500000000.00'), 'allocated_percentage': Decimal('70.00'), 'remaining_percentage': Decimal('30.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': 'کلان بودجه شش ماهه 1404', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-19 15:55:55] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 4 records
[2025-07-19 15:55:55] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEEF80F50>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: دفتر مرکزی شرکت توسعه گردشگری ایران - بازسازی و مرمت - 1404/04/28 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: دفتر مرکزی شرکت توسعه گردشگری ایران - بازسازی و مرمت - 1404/04/28 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x0000028EEF0B4770>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('1500000000.00'), 'total_allocated': Decimal('3500000000.00'), 'allocated_percentage': Decimal('70.00'), 'remaining_percentage': Decimal('30.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': '', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-19 15:56:07] DEBUG [budgets.Payee.view_Payee:42] get_context_data - PayeeListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEEFD8650>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<Payee: توحید (EMPLOYEE)>]>, 'payees': <QuerySet [<Payee: توحید (EMPLOYEE)>]>, 'view': <budgets.Payee.view_Payee.PayeeListView object at 0x0000028EEE90AA50>, 'query': '', 'payee_type': '', 'payee_types': (('VENDOR', 'فروشنده'), ('EMPLOYEE', 'کارمند'), ('OTHER', 'دیگر'))}
[2025-07-19 15:56:09] DEBUG [budgets.Payee.view_Payee:42] get_context_data - PayeeListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEEF85F40>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<Payee: توحید (EMPLOYEE)>]>, 'payees': <QuerySet [<Payee: توحید (EMPLOYEE)>]>, 'view': <budgets.Payee.view_Payee.PayeeListView object at 0x0000028EEE77A350>, 'query': '', 'payee_type': '', 'payee_types': (('VENDOR', 'فروشنده'), ('EMPLOYEE', 'کارمند'), ('OTHER', 'دیگر'))}
[2025-07-19 15:56:17] DEBUG [budgets.views:92] get_context_data - TransactionTypeListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEEF87800>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<TransactionType: بیمه تامین اجتماعی شرکت توسعه گردشگری ایران>, <TransactionType: بیمه تامین اجتماعی میراث>]>, 'transaction_types': <QuerySet [<TransactionType: بیمه تامین اجتماعی شرکت توسعه گردشگری ایران>, <TransactionType: بیمه تامین اجتماعی میراث>]>, 'view': <budgets.views.TransactionTypeListView object at 0x0000028EEE90A120>, 'query': '', 'requires_extra_approval': ''}
[2025-07-19 15:56:26] INFO [budgets.BudgetAllocation.views_BudgetAllocation:183] get_queryset - BudgetAllocationListView queryset: 4 records
[2025-07-19 15:56:26] DEBUG [budgets.BudgetAllocation.views_BudgetAllocation:364] get_context_data - BudgetAllocationListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEEA0E030>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<BudgetAllocation: دفتر مرکزی شرکت توسعه گردشگری ایران - بازسازی و مرمت - 1404/04/28 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'budget_allocations': <QuerySet [<BudgetAllocation: دفتر مرکزی شرکت توسعه گردشگری ایران - بازسازی و مرمت - 1404/04/28 - 500,000,000 ریال>, <BudgetAllocation: مجتمع آبدرمانی سبلان - بازسازی و مرمت - 1404/04/24 - 2,000,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/18 - 500,000,000 ریال>, <BudgetAllocation: هتل لاله سرعین - بازسازی و مرمت - 1404/04/15 - 500,000,000 ریال>]>, 'view': <budgets.BudgetAllocation.views_BudgetAllocation.BudgetAllocationListView object at 0x0000028EEF0B4770>, 'total_budget': Decimal('5000000000'), 'remaining_budget': Decimal('1500000000.00'), 'total_allocated': Decimal('3500000000.00'), 'allocated_percentage': Decimal('70.00'), 'remaining_percentage': Decimal('30.00'), 'budget_item_data': {}, 'project_data': {}, 'budget_items': <QuerySet [<BudgetItem: کلان بودجه شش ماهه 1404 - بازسازی و مرمت - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پژوهشی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پذیرایی - دفتر مرکزی شرکت توسعه گردشگری ایران>, <BudgetItem: کلان بودجه شش ماهه 1404 - پرسنلی - دفتر مرکزی شرکت توسعه گردشگری ایران>]>, 'organizations': <QuerySet [<Organization: HSarein - هتل لاله سرعین (هتل)>, <Organization: Htehran - هتل لاله تهران (هتل)>, <Organization: Hcha - هتل لاله چابهار (هتل)>, <Organization: Hkan - هتل لاله کندوان (هتل)>, <Organization: Hbis - هتل لاله بیستون (هتل)>, <Organization: ComplexSHC - مجتمع آبدرمانی سبلان (هتل)>, <Organization: HQ_ITDC - دفتر مرکزی شرکت توسعه گردشگری ایران (دفتر مرکزی)>]>, 'budget_periods': <QuerySet [<BudgetPeriod: کلان بودجه شش ماهه 1404 (HQ_ITDC)>]>, 'projects': <QuerySet [<Project: HQ-P001 - اجرای اتاق سرور دفتر مرکزی (فعال)>, <Project: HSAR-Flor3 - بازسازی هتل - طبقه سوم لاله سرعین (فعال)>, <Project: HKan-ServerRoom - بازسازی اتاق سرور هتل لاله کندوان (فعال)>, <Project: HSar-Engining - بازسازی تاسیسات هتل (فعال)>, <Project: HHydro-1404 - بازسازی مجتمع آبدرمانی سبلان - لوله کشی آبگرم (فعال)>]>, 'status': 'filtered', 'status_message': 'نمایش تخصیص\u200cهای فیلترشده', 'query': '', 'date_from': '', 'date_to': '', 'selected_budget_item': None, 'selected_organization': None, 'selected_budget_period': None, 'selected_project': None, 'selected_allocation_date': None}
[2025-07-19 15:56:34] INFO [budgets.PaymentOrder.view_PaymentOrder:657] get_context_data - Context prepared for user admin, 0 payment orders, 0 approved factors
[2025-07-19 16:01:08] DEBUG [budgets.ProjectBudgetAllocation.view_Update_Project_Budget_Allocation:283] dispatch - Dispatching request for allocation edit, pk=73, user=admin
[2025-07-19 16:01:08] DEBUG [budgets.ProjectBudgetAllocation.view_Update_Project_Budget_Allocation:33] get_object - Attempting to get BudgetAllocation with pk=73 for user=admin
[2025-07-19 16:01:08] DEBUG [budgets.ProjectBudgetAllocation.view_Update_Project_Budget_Allocation:42] get_object - Authorized organizations: [{'id': 1, 'name': 'هتل لاله سرعین'}, {'id': 2, 'name': 'هتل لاله تهران'}, {'id': 3, 'name': 'هتل لاله چابهار'}, {'id': 4, 'name': 'هتل لاله کندوان'}, {'id': 5, 'name': 'هتل لاله بیستون'}, {'id': 6, 'name': 'مجتمع آبدرمانی سبلان'}, {'id': 7, 'name': 'دفتر مرکزی شرکت توسعه گردشگری ایران'}]
[2025-07-19 16:01:08] ERROR [budgets.ProjectBudgetAllocation.view_Update_Project_Budget_Allocation:289] dispatch - Error accessing allocation: 'BudgetAllocation' object has no attribute 'budget_allocation'
Traceback (most recent call last):
  File "D:\Design & Source Code\Source Coding\Tanbakhsystem\budgets\ProjectBudgetAllocation\view_Update_Project_Budget_Allocation.py", line 285, in dispatch
    allocation = self.get_object()
  File "D:\Design & Source Code\Source Coding\Tanbakhsystem\budgets\ProjectBudgetAllocation\view_Update_Project_Budget_Allocation.py", line 43, in get_object
    logger.debug(f"Allocation organization: {allocation.budget_allocation.organization}")
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BudgetAllocation' object has no attribute 'budget_allocation'
[2025-07-19 16:01:18] INFO [budgets.PaymentOrder.view_PaymentOrder:657] get_context_data - Context prepared for user admin, 0 payment orders, 0 approved factors
[2025-07-19 16:01:21] DEBUG [budgets.views:92] get_context_data - TransactionTypeListView context: {'paginator': <django.core.paginator.Paginator object at 0x0000028EEF422E50>, 'page_obj': <Page 1 of 1>, 'is_paginated': False, 'object_list': <QuerySet [<TransactionType: بیمه تامین اجتماعی شرکت توسعه گردشگری ایران>, <TransactionType: بیمه تامین اجتماعی میراث>]>, 'transaction_types': <QuerySet [<TransactionType: بیمه تامین اجتماعی شرکت توسعه گردشگری ایران>, <TransactionType: بیمه تامین اجتماعی میراث>]>, 'view': <budgets.views.TransactionTypeListView object at 0x0000028EEE6AF610>, 'query': '', 'requires_extra_approval': ''}
[2025-07-19 19:25:10] INFO [budgets.PaymentOrder.view_PaymentOrder:657] get_context_data - Context prepared for user admin, 0 payment orders, 0 approved factors
[2025-07-19 19:29:29] DEBUG [budgets.models:549] save - Starting save for BudgetTransaction: amount=9200000, type=CONSUMPTION, allocation ID=72
[2025-07-19 19:29:29] DEBUG [budgets.models:538] clean - Cleaning BudgetTransaction: amount=9200000, type=CONSUMPTION, allocation ID=72
[2025-07-19 19:29:29] INFO [budgets.models:545] clean - BudgetTransaction validated successfully for allocation ID: 72
[2025-07-19 19:29:29] DEBUG [budgets.signals:31] update_remaining_amount - BudgetTransaction TX-FACTOR-NEW-7-1752940769.654736 created. Invalidating cache for allocation 72
[2025-07-19 19:29:29] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'free_budget_72', 'tankhah_report_21_no_filters'}
[2025-07-19 19:29:29] DEBUG [budgets.signals:37] update_remaining_amount - Updated remaining_budget for Tankhah 3
[2025-07-19 19:29:29] DEBUG [budgets.signals:55] invalidate_transaction_cache - Invalidated cache keys after BudgetTransaction change: {'returned_budgets_21_all_no_filters', 'project_remaining_budget_8', 'budget_transfers_21_no_filters', 'free_budget_72'}
[2025-07-19 19:29:29] INFO [budgets.models:559] save - BudgetTransaction saved with ID: 67
[2025-07-19 19:52:31] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'free_budget_72', 'tankhah_report_21_no_filters'}
[2025-07-19 20:15:02] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'free_budget_72', 'tankhah_report_21_no_filters'}
[2025-07-19 20:23:47] DEBUG [budgets.signals:85] invalidate_tankhah_cache - Invalidated cache keys after Tankhah change: {'free_budget_72', 'tankhah_report_21_no_filters'}
