{#{% extends 'base.html' %}#}
{% load i18n jformat rcms_custom_filters static humanize %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
    </head>
    <body>


    <!-- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² -->
    <link rel="stylesheet" href="{% static 'admin/css/bootstrap.rtl.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/css/jalalidatepicker.min.css' %}">

    <!-- ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ§Ø±ÛŒØ® -->
    <div class="row mt-4">
        <div class="col-md-6">
            <label for="start_date" class="form-label">ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹</label>
            <input type="text" id="start_date" class="form-control" data-jdp placeholder="Ù…Ø«Ù„Ø§Ù‹ 1403/01/01">
        </div>
        <div class="col-md-6">
            <label for="end_date" class="form-label">ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù†</label>
            <input type="text" id="end_date" class="form-control" data-jdp placeholder="Ù…Ø«Ù„Ø§Ù‹ 1403/02/01">
        </div>
    </div>
<h2><strong style="color: red">"data-jdp" Ø§ÛŒÙ† Ù…Ù‡Ù… Ø¨ÙˆØ¯Ù‡ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø¯Ø± ØªÚ¯ ØªØ§Ø±ÛŒØ® Ù…ÛŒØ§Ù…Ø¯ </strong> </h2>
    <!-- Ù¾ÛŒØ§Ù… Ù‡Ø´Ø¯Ø§Ø± -->
    <div id="date-error" class="text-danger mt-2 d-none">
        ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù† Ù†Ø¨Ø§ÛŒØ¯ Ù‚Ø¨Ù„ Ø§Ø² ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø´Ø¯.
    </div>

    <!-- Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² -->
    <script src="{% static 'admin/js/jquery-3.6.0.min.js' %}"></script>
    <script src="{% static 'admin/js/jalalidatepicker.min.js' %}"></script>

    <script>
        $(document).ready(function () {
            // ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø¯ÛŒØªØ§Ù¾ÛŒÚ©Ø±
            jalaliDatepicker.startWatch();

            function convertToNumber(dateStr) {
                return parseInt(dateStr.replace(/\//g, ''), 10);  // ØªØ¨Ø¯ÛŒÙ„ "1403/01/15" Ø¨Ù‡ 14030115
            }

            // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ùˆ Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ®
            $('#start_date').on('change', function () {
                const startVal = $(this).val();
                $('#end_date').val(''); // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù† Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø­Ø§Ù„Øª Ù†Ø§Ù…Ø¹ØªØ¨Ø±
                $('#date-error').addClass('d-none');

                // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù† Ø¨Ù‡ Ø¨Ø¹Ø¯ Ø§Ø² ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹
                jalaliDatepicker.updateOptions('#end_date', {
                    minDate: startVal
                });
            });

            $('#end_date').on('change', function () {
                const start = $('#start_date').val();
                const end = $(this).val();
                if (start && end) {
                    const startNum = convertToNumber(start);
                    const endNum = convertToNumber(end);
                    if (endNum < startNum) {
                        $('#date-error').removeClass('d-none');
                    } else {
                        $('#date-error').addClass('d-none');
                    }
                }
            });
        });
    </script>


    </body>
    </html>
{% endblock %}

<!--
Ø¹Ø§Ù„ÛŒØŒ Ù¾Ø³ Ø¨Ø±ÛŒÙ… Ø³Ø±Ø§Øº Ø­Ø§Ù„Øªâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡â€ŒØªØ± Ø¨Ø±Ø§ÛŒ `jalalidatepicker` Ú©Ù‡ ÙˆØ§Ù‚Ø¹Ø§Ù‹ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒâ€ŒØ§Ù† â€“ Ù…Ø®ØµÙˆØµØ§Ù‹ ÙˆÙ‚ØªÛŒ Ù…ÛŒâ€ŒØ®ÙˆØ§ÛŒ ØªÙˆÛŒ ÙØ±Ù… Django Ù‡Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒ. Ø¨Ù‡â€ŒØµÙˆØ±Øª Ú©Ø§Ù…Ù„ ØªÙˆØ¶ÛŒØ­ Ù…ÛŒâ€ŒØ¯Ù…:

---

## ğŸŸ¢ Û±. Ø§ØªØµØ§Ù„ Ø¨Ù‡ `forms.DateField` Ø¯Ø± Django

Ø§Ú¯Ø± Ø§Ø² ÛŒÚ© ÙØ±Ù… Django Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØŒ ÙØ±Ø¶ Ú©Ù† ÙÛŒÙ„Ø¯Øª Ø§ÛŒÙ†Ù‡:

```python
# forms.py
from django import forms

class MyForm(forms.Form):
    start_date = forms.DateField(
        widget=forms.TextInput(attrs={
            'class': 'form-control',
            'id': 'start_date',
            'data-jdp': True,
            'placeholder': 'Ù…Ø«Ù„Ø§Ù‹ 1403/01/01'
        })
    )
```

Ø¯Ø§Ø®Ù„ Ù‚Ø§Ù„Ø¨ ÙÙ‚Ø· Ø§ÛŒÙ†Ùˆ Ø¨Ø°Ø§Ø±:

```html
<form method="post">
    {% csrf_token %}
    {{ form.start_date }}
</form>
```

Ùˆ Ù‡Ù…ÙˆÙ† `jalalidatepicker.startWatch()` Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø±ÙˆÛŒ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø¨Ø§ `data-jdp` Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù‡.

---

## ğŸŸ¢ Û². Ø§Ù†ØªØ®Ø§Ø¨ ØªØ§Ø±ÛŒØ® Ø¨Ø§ Ø²Ù…Ø§Ù† (ØªØ§Ø±ÛŒØ® + Ø³Ø§Ø¹Øª)

Ù…ØªØ£Ø³ÙØ§Ù†Ù‡ `jalalidatepicker` Ø¨Ù‡â€ŒØµÙˆØ±Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨ **Ø²Ù…Ø§Ù†** (Ø³Ø§Ø¹Øª Ùˆ Ø¯Ù‚ÛŒÙ‚Ù‡) Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ù‡.

âœ… Ø§Ù…Ø§ Ø±Ø§Ù‡Ú©Ø§Ø±:
Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø¨Ù‡ ØµÙˆØ±Øª Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ ÛŒÙ‡ `select` Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø¹Øª Ùˆ Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¨Ø°Ø§Ø±ÛŒ Ú©Ù†Ø§Ø± ÙÛŒÙ„Ø¯ ØªØ§Ø±ÛŒØ® ÛŒØ§ Ø§Ø² `persian-datepicker` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒ Ú©Ù‡ ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† Ø±Ùˆ Ø¨Ø§ Ù‡Ù… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù‡.

Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ Ø§Ø² Ø§ÙˆÙ†Ùˆ Ø§Ú¯Ù‡ Ø®ÙˆØ§Ø³ØªÛŒ Ø¨Ø±Ø§Øª Ù…ÛŒâ€ŒÙ†ÙˆÛŒØ³Ù… (Ø¨Ø§ `persian-date.min.js` Ùˆ `persian-datepicker.min.js`).

---

## ğŸŸ¢ Û³. Ù¾ÛŒØ´â€ŒÙØ±Ø¶â€ŒÚ¯Ø°Ø§Ø±ÛŒ ØªØ§Ø±ÛŒØ®

Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§ÛŒ ØªØ§Ø±ÛŒØ® Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø³Øª Ø¨Ø§Ø´Ù‡:

```html
<input type="text" id="start_date" data-jdp value="1403/01/01">
```

ÛŒØ§ Ø¯Ø± Django:

```python
start_date = forms.DateField(
    initial='1403/01/01',
    widget=forms.TextInput(attrs={'data-jdp': True})
)
```

---

## ğŸŸ¢ Û´. ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø±ÙˆØ²Ù‡Ø§ÛŒ Ø®Ø§Øµ

Ø§ÛŒÙ† Ù…ÙˆØ±Ø¯ ØªÙˆØ³Ø· Ø®ÙˆØ¯ `jalalidatepicker` Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒØ´Ù‡ØŒ Ø§Ù…Ø§ Ø¨Ø§ Ú©Ù…ÛŒ Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¯Ø³ØªÛŒ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ù…Ø§Ù†Ø¹ Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ² Ø®Ø§Øµ Ø¨Ø´ÛŒ:

```js
$('#start_date').on('change', function () {
    const selected = $(this).val();
    const bannedDates = ['1403/01/13', '1403/02/01'];
    if (bannedDates.includes(selected)) {
        alert('Ø§ÛŒÙ† ØªØ§Ø±ÛŒØ® Ù…Ø¬Ø§Ø² Ù†ÛŒØ³Øª!');
        $(this).val('');
    }
});
```

---

## ğŸŸ¢ Ûµ. ØªØ¨Ø¯ÛŒÙ„ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ ÙØ±Ù…Øª Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø¯Ø± ÙØ±Ù… Django

Ø¯Ø§Ø®Ù„ ÙˆÛŒÙˆ ÛŒØ§ ÙØ±Ù… `clean`:

```python
from khayyam import JalaliDate
import datetime

class MyForm(forms.Form):
    start_date = forms.CharField()

    def clean_start_date(self):
        value = self.cleaned_data['start_date']  # Ù…Ø«Ù„Ø§Ù‹ '1403/01/15'
        parts = list(map(int, value.split('/')))
        # ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ù…ÛŒÙ„Ø§Ø¯ÛŒ
        try:
            gregorian = JalaliDate(parts[0], parts[1], parts[2]).todate()
        except:
            raise forms.ValidationError("ØªØ§Ø±ÛŒØ® Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.")
        return gregorian
```

---

## âœ… Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ

| ÙˆÛŒÚ˜Ú¯ÛŒ                       | Ø§Ù…Ú©Ø§Ù†â€ŒÙ¾Ø°ÛŒØ±ØŸ | ØªÙˆØ¶ÛŒØ­ |
|----------------------------|-------------|--------|
| Ø§ØªØµØ§Ù„ Ø¨Ù‡ `DateField`        | âœ…          | Ø¨Ø§ `data-jdp` Ø¨Ù‡ Ø±Ø§Ø­ØªÛŒ |
| ØªØ§Ø±ÛŒØ® + Ø²Ù…Ø§Ù†               | âŒ / Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† | Ø¨Ø§ Ù¾Ù„Ø§Ú¯ÛŒÙ† Ø¯ÛŒÚ¯Ø± Ù…Ø«Ù„ `persian-datepicker` |
| ØªØ§Ø±ÛŒØ® Ù¾ÛŒØ´â€ŒÙØ±Ø¶              | âœ…          | Ø¨Ø§ `value` ÛŒØ§ `initial` |
| Ø±ÙˆØ²Ù‡Ø§ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„             | âš ï¸ Ø¨Ø§ Ú©Ø¯Ù†ÙˆÛŒØ³ÛŒ Ø¯Ø³ØªÛŒ |
| ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø¯Ø± `clean` | âœ…          | Ø¨Ø§ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ `khayyam` ÛŒØ§ `jdatetime` |

---

Ø§Ú¯Ù‡ Ø®ÙˆØ§Ø³ØªÛŒ Ù†Ø³Ø®Ù‡ Ú©Ø§Ù…Ù„ Ø¨Ø§ `persian-datepicker` Ø¨Ù†ÙˆÛŒØ³Ù… Ú©Ù‡ ØªØ§Ø±ÛŒØ® + Ø²Ù…Ø§Ù† Ùˆ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø±ÙˆØ² Ù‡Ù… Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù‡ØŒ ÙÙ‚Ø· Ø¨Ú¯Ùˆ ğŸ’¡

Ù‡Ù…Ú†Ù†ÛŒÙ† Ø¨Ú¯Ùˆ Ø§Ø² `ModelForm` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒ ÛŒØ§ ÙØ±Ù… Ø¯Ø³ØªÛŒØŒ ØªØ§ Ú©Ø¯ Ø¯Ù‚ÛŒÙ‚â€ŒØªØ±ÛŒ Ø¨ÙØ±Ø³ØªÙ….
-->