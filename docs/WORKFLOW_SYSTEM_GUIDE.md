# ุฑุงูููุง ฺฉุงูู ุณุณุชู ฺฏุฑุฏุด ฺฉุงุฑ (Workflow Management System)

## ๐ ููุฑุณุช ูุทุงูุจ
1. [ูุนุฑู ุณุณุชู](#ูุนุฑู-ุณุณุชู)
2. [ููุงูู ฺฉูุฏ](#ููุงูู-ฺฉูุฏ)
3. [ูุญูู ุงุณุชูุงุฏู](#ูุญูู-ุงุณุชูุงุฏู)
4. [ูุฏุฑุช ุชููพูุชโูุง](#ูุฏุฑุช-ุชููพูุชโูุง)
5. [ููุงูู ู ูุญุฏูุฏุชโูุง](#ููุงูู-ู-ูุญุฏูุฏุชโูุง)
6. [ุณุงุฒูุงูโูุง ูุฑฺฉุฒ](#ุณุงุฒูุงูโูุง-ูุฑฺฉุฒ)
7. [ุชุณุช ู ุงุนุชุจุงุฑุณูุฌ](#ุชุณุช-ู-ุงุนุชุจุงุฑุณูุฌ)
8. [ูุดฺฉูุงุช ุฑุงุฌ](#ูุดฺฉูุงุช-ุฑุงุฌ)
9. [ุจูุชุฑู ุฑูุดโูุง](#ุจูุชุฑู-ุฑูุดโูุง)

---

## ๐ฏ ูุนุฑู ุณุณุชู

ุณุณุชู ฺฏุฑุฏุด ฺฉุงุฑ ฺฉ ุณุณุชู ูพุดุฑูุชู ุจุฑุง ูุฏุฑุช ูุฑุขูุฏูุง ุชุงุฏ ุฏุฑ ุณุณุชู ุจูุฏุฌูโุจูุฏ ุงุณุช ฺฉู ุดุงูู:

- **ุชููพูุชโูุง ฺฏุฑุฏุด ฺฉุงุฑ**: ูุงูุจโูุง ุงุฒ ูพุด ุชุนุฑู ุดุฏู ุจุฑุง ูุฑุขูุฏูุง ูุฎุชูู
- **ูุถุนุชโูุง**: ูุฑุงุญู ูุฎุชูู ฺฉ ูุฑุขูุฏ (ูพุดโููุณุ ุชุงุฏุ ุฑุฏ)
- **ุงูุฏุงูุงุช**: ุนููุงุช ูุงุจู ุงูุฌุงู ุฏุฑ ูุฑ ูุฑุญูู
- **ุงูุชูุงูโูุง**: ูุณุฑูุง ูุฌุงุฒ ุจู ูุถุนุชโูุง
- **ุณุงุฒูุงูโูุง**: ูุฑุงฺฉุฒ ูุฎุชูู ฺฉู ููุงูู ุฎุงุต ุฎูุฏ ุฑุง ุฏุงุฑูุฏ

---

## ๐ง ููุงูู ฺฉูุฏ

### 1. ูุถุนุชโูุง (Statuses)
```python
# ุงููุงุน ูุถุนุชโูุง
DRAFT = "ูพุดโููุณ"           # ูุถุนุช ุงููู
SUBMITTED = "ุงุฑุณุงู ุดุฏู"      # ุฏุฑ ุงูุชุธุงุฑ ุชุงุฏ
APPROVED = "ุชุงุฏ ุดุฏู"       # ุชุงุฏ ุดุฏู
REJECTED = "ุฑุฏ ุดุฏู"          # ุฑุฏ ุดุฏู
FINAL = "ููุง"             # ูุถุนุช ููุง
```

### 2. ุงูุฏุงูุงุช (Actions)
```python
# ุงูุฏุงูุงุช ูุงุจู ุงูุฌุงู
SUBMIT = "ุงุฑุณุงู"            # ุงุฑุณุงู ุจุฑุง ุชุงุฏ
APPROVE = "ุชุงุฏ"           # ุชุงุฏ
REJECT = "ุฑุฏ"               # ุฑุฏ
RETURN = "ุจุฑฺฏุฑุฏุงูุฏู"        # ุจุฑฺฏุฑุฏุงูุฏู ุจุฑุง ุงุตูุงุญ
```

### 3. ุงูุชูุงูโูุง (Transitions)
```python
# ูุซุงู ุงูุชูุงู
{
    'from_status': 'DRAFT',
    'to_status': 'SUBMITTED',
    'action': 'SUBMIT',
    'organization': 'ุฏูุชุฑ ูุฑฺฉุฒ',
    'entity_type': 'PAYMENTORDER'
}
```

---

## ๐ ูุญูู ุงุณุชูุงุฏู

### 1. ุงุฌุงุฏ ุชููพูุช ุฌุฏุฏ
```bash
# URL: /workflow-management/templates/create/
# ูุฑุงุญู:
1. ุงูุชุฎุงุจ ูุงู ู ุชูุถุญุงุช
2. ุงูุชุฎุงุจ ุณุงุฒูุงู
3. ุงูุชุฎุงุจ ููุน ููุฌูุฏุช
4. ุชุนุฑู ูุถุนุชโูุง
5. ุชุนุฑู ุงูุฏุงูุงุช
6. ุชุนุฑู ุงูุชูุงูโูุง
```

### 2. ุงุนูุงู ุชููพูุช
```bash
# URL: /workflow-management/templates/{id}/apply/
# ูุฑุงุญู:
1. ุงูุชุฎุงุจ ุณุงุฒูุงู ููุตุฏ
2. ุชุงุฏ ุงุนูุงู
3. ุจุฑุฑุณ ูุชุฌู
```

### 3. ูุฏุฑุช ููุงูู
```bash
# URL: /workflow-management/templates/
# ูุงุจูุชโูุง:
- ูุดุงูุฏู ูุณุช ุชููพูุชโูุง
- ูุฑุงุด ุชููพูุชโูุง
- ุญุฐู ุชููพูุชโูุง
- ฺฉูพ ุชููพูุชโูุง
```

---

## ๐ ูุฏุฑุช ุชููพูุชโูุง

### ุชููพูุช ุชุงุฏ ุฏุณุชูุฑ ูพุฑุฏุงุฎุช
```python
# ุณุงุฎุชุงุฑ ุชููพูุช
{
    'name': 'ุชููพูุช ุชุงุฏ ุฏุณุชูุฑ ูพุฑุฏุงุฎุช',
    'description': 'ุชููพูุช ฺฉุงูู ุจุฑุง ูุฑุขูุฏ ุชุงุฏ ุฏุณุชูุฑ ูพุฑุฏุงุฎุช',
    'organization': 'ูุชู ูุงูู ุณุฑุนู',
    'entity_type': 'PAYMENTORDER',
    'statuses': [
        {'code': 'DRAFT', 'name': 'ูพุดโููุณ', 'is_initial': True},
        {'code': 'SUBMITTED', 'name': 'ุงุฑุณุงู ุดุฏู'},
        {'code': 'MANAGER_APPROVED', 'name': 'ุชุงุฏ ูุฏุฑ'},
        {'code': 'FINANCE_APPROVED', 'name': 'ุชุงุฏ ูุงู'},
        {'code': 'CEO_APPROVED', 'name': 'ุชุงุฏ ูุฏุฑุนุงูู', 'is_final': True},
        {'code': 'REJECTED', 'name': 'ุฑุฏ ุดุฏู', 'is_final': True}
    ],
    'actions': [
        {'code': 'SUBMIT', 'name': 'ุงุฑุณุงู'},
        {'code': 'APPROVE', 'name': 'ุชุงุฏ'},
        {'code': 'REJECT', 'name': 'ุฑุฏ'},
        {'code': 'RETURN', 'name': 'ุจุฑฺฏุฑุฏุงูุฏู'},
        {'code': 'FINAL_APPROVE', 'name': 'ุชุงุฏ ููุง'}
    ],
    'transitions': [
        # ูุณุฑูุง ูุฌุงุฒ ุจู ูุถุนุชโูุง
    ]
}
```

---

## ๐ข ููุงูู ู ูุญุฏูุฏุชโูุง

### 1. ููุงูู ุนููู
- โ ูุฑ ุชููพูุช ุจุงุฏ ุญุฏุงูู ฺฉ ูุถุนุช ุงููู ุฏุงุดุชู ุจุงุดุฏ
- โ ูุฑ ุชููพูุช ุจุงุฏ ุญุฏุงูู ฺฉ ูุถุนุช ููุง ุฏุงุดุชู ุจุงุดุฏ
- โ ุงูุชูุงูโูุง ุจุงุฏ ููุทู ุจุงุดูุฏ
- โ ุงูุฏุงูุงุช ุจุงุฏ ุจุง ูุถุนุชโูุง ุณุงุฒฺฏุงุฑ ุจุงุดูุฏ

### 2. ููุงูู ุณุงุฒูุงู
- ๐ข **ุฏูุชุฑ ูุฑฺฉุฒ**: ุชุงุฏูโูุง ููุง
- ๐ข **ุดุนุจ**: ุชุงุฏูโูุง ูุญู
- ๐ข **ุจุฎุด ูุงู**: ุชุงุฏูโูุง ูุงู
- ๐ข **ูุฏุฑุช**: ุชุงุฏูโูุง ูุฏุฑุช

### 3. ูุญุฏูุฏุชโูุง ุฏุณุชุฑุณ
```python
# ูุซุงู ูุญุฏูุฏุช ุฏุณุชุฑุณ
def can_approve(user, organization, entity_type):
    if organization.is_central_office:
        return user.has_perm('core.central_approve')
    else:
        return user.has_perm('core.local_approve')
```

---

## ๐๏ธ ุณุงุฒูุงูโูุง ูุฑฺฉุฒ

### ุชุนุฑู ุณุงุฒูุงู ูุฑฺฉุฒ
```python
# ุฏุฑ ูุฏู Organization
class Organization(models.Model):
    name = models.CharField(max_length=200)
    is_central_office = models.BooleanField(default=False)
    parent_organization = models.ForeignKey('self', null=True, blank=True)
    
    def is_central(self):
        return self.is_central_office
```

### ููุงูู ุฎุงุต ูุฑฺฉุฒ
```python
# ูุซุงู ููุงูู ูุฑฺฉุฒ
CENTRAL_APPROVAL_RULES = {
    'PAYMENTORDER': {
        'min_amount': 1000000,  # ุญุฏุงูู ูุจูุบ ุจุฑุง ุชุงุฏ ูุฑฺฉุฒ
        'required_approvals': ['MANAGER', 'FINANCE', 'CEO'],
        'central_only': True
    },
    'FACTOR': {
        'min_amount': 500000,
        'required_approvals': ['MANAGER', 'FINANCE'],
        'central_only': False
    }
}
```

---

## ๐งช ุชุณุช ู ุงุนุชุจุงุฑุณูุฌ

### 1. ุงุนุชุจุงุฑุณูุฌ ุฎูุฏฺฉุงุฑ
```python
# ุจุฑุฑุณ ุณุงุฒฺฏุงุฑ ููุงูู
def validate_workflow_consistency(organization, entity_type):
    issues = []
    
    # ุจุฑุฑุณ ูุฌูุฏ ูุถุนุช ุงููู
    if not Status.objects.filter(is_initial=True).exists():
        issues.append("ูฺ ูุถุนุช ุงูููโุง ุชุนุฑู ูุดุฏู ุงุณุช")
    
    # ุจุฑุฑุณ ูุฌูุฏ ูุถุนุช ููุง
    if not Status.objects.filter(is_final_approve=True).exists():
        issues.append("ูฺ ูุถุนุช ููุงโุง ุชุนุฑู ูุดุฏู ุงุณุช")
    
    return issues
```

### 2. ุชุณุช ุชููพูุช
```python
# ุชุณุช ุชููพูุช
def test_template(template_id):
    template = WorkflowRuleTemplate.objects.get(id=template_id)
    
    # ุชุณุช ุงุฌุงุฏ ูุถุนุชโูุง
    for status_data in template.rules_data['statuses']:
        status = Status.objects.create(**status_data)
        assert status.is_active
    
    # ุชุณุช ุงุฌุงุฏ ุงูุฏุงูุงุช
    for action_data in template.rules_data['actions']:
        action = Action.objects.create(**action_data)
        assert action.is_active
    
    # ุชุณุช ุงุฌุงุฏ ุงูุชูุงูโูุง
    for transition_data in template.rules_data['transitions']:
        transition = Transition.objects.create(**transition_data)
        assert transition.is_active
```

---

## โ ูุดฺฉูุงุช ุฑุงุฌ

### 1. ุฎุทุง HTTP 405
```bash
# ูุดฺฉู: Method Not Allowed
# ุญู: ุงุถุงูู ฺฉุฑุฏู GET method ุจู view
@login_required
def apply_template_to_organization(request, template_id):
    if request.method == 'GET':
        # ููุงุด ูุฑู
    elif request.method == 'POST':
        # ูพุฑุฏุงุฒุด ูุฑู
```

### 2. ุฎุทุง ููุฏ organization
```bash
# ูุดฺฉู: Cannot resolve keyword 'organization'
# ุญู: ุญุฐู ููุฏ organization ุงุฒ query
# ูุจู: Status.objects.filter(organization=org)
# ุจุนุฏ: Status.objects.filter(is_active=True)
```

### 3. ุฎุทุง postaction
```bash
# ูุดฺฉู: Cannot resolve keyword 'postaction'
# ุญู: ุงุตูุงุญ ูุงู ููุฏ
# ูุจู: .exclude(postaction__isnull=False)
# ุจุนุฏ: .exclude(postruleassignment__isnull=False)
```

---

## ๐ก ุจูุชุฑู ุฑูุดโูุง

### 1. ุทุฑุงุญ ุชููพูุช
- โ **ุณุงุฏู ุดุฑูุน ฺฉูุฏ**: ุงุจุชุฏุง ฺฉ ุชููพูุช ุณุงุฏู ุงุฌุงุฏ ฺฉูุฏ
- โ **ุชุณุช ฺฉูุฏ**: ูุฑ ูุฑุญูู ุฑุง ุชุณุช ฺฉูุฏ
- โ **ูุณุชูุฏ ฺฉูุฏ**: ุชุบุฑุงุช ุฑุง ูุณุชูุฏ ฺฉูุฏ
- โ **ุจฺฉโุขูพ ุจฺฏุฑุฏ**: ูุจู ุงุฒ ุชุบุฑุงุช ููู ุจฺฉโุขูพ ุจฺฏุฑุฏ

### 2. ูุฏุฑุช ููุงูู
- โ **ููุทู ุจุงุดุฏ**: ููุงูู ุจุงุฏ ููุทู ุจุงุดูุฏ
- โ **ุณุงุฒฺฏุงุฑ ุจุงุดุฏ**: ููุงูู ุจุงุฏ ุจุง ฺฉุฏฺฏุฑ ุณุงุฒฺฏุงุฑ ุจุงุดูุฏ
- โ **ุงูุนุทุงูโูพุฐุฑ ุจุงุดุฏ**: ููุงูู ุจุงุฏ ูุงุจู ุชุบุฑ ุจุงุดูุฏ
- โ **ุงูู ุจุงุดุฏ**: ุฏุณุชุฑุณโูุง ุฑุง ฺฉูุชุฑู ฺฉูุฏ

### 3. ูฺฏูุฏุงุฑ ุณุณุชู
- โ **ููุธู ุจุงุดุฏ**: ฺฉุฏ ุฑุง ููุธู ูฺฏู ุฏุงุฑุฏ
- โ **ุชุณุช ฺฉูุฏ**: ุชุบุฑุงุช ุฑุง ุชุณุช ฺฉูุฏ
- โ **ูุณุชูุฏ ฺฉูุฏ**: ุชุบุฑุงุช ุฑุง ูุณุชูุฏ ฺฉูุฏ
- โ **ุจฺฉโุขูพ ุจฺฏุฑุฏ**: ุจฺฉโุขูพ ููุธู ุจฺฏุฑุฏ

---

## ๐ ุจุฑุฑุณ ฺฉุฏูุง ูุงุฑุฏฺฉุฏ

### 1. ุจุฑุฑุณ ูุงูโูุง ููู
```bash
# ูุงูโูุง ููู ุจุฑุง ุจุฑุฑุณ
grep -r "hardcoded" core/
grep -r "if.*organization" core/
grep -r "if.*entity_type" core/
```

### 2. ูุซุงูโูุง ูุงุฑุฏฺฉุฏ
```python
# ูุซุงู ูุงุฑุฏฺฉุฏ (ุจุฏ)
if organization.name == "ุฏูุชุฑ ูุฑฺฉุฒ":
    # ฺฉุฏ ุฎุงุต ูุฑฺฉุฒ

# ูุซุงู ุจูุชุฑ
if organization.is_central_office:
    # ฺฉุฏ ุฎุงุต ูุฑฺฉุฒ
```

### 3. ุงุตูุงุญ ูุงุฑุฏฺฉุฏูุง
```python
# ูุจู (ูุงุฑุฏฺฉุฏ)
def get_approval_flow(organization_name):
    if organization_name == "ุฏูุชุฑ ูุฑฺฉุฒ":
        return CENTRAL_FLOW
    else:
        return LOCAL_FLOW

# ุจุนุฏ (ูพฺฉุฑุจูุฏ)
def get_approval_flow(organization):
    if organization.is_central_office:
        return organization.central_flow
    else:
        return organization.local_flow
```

---

## ๐ ฺฏุฒุงุฑุดโฺฏุฑ

### 1. ฺฏุฒุงุฑุด ุชููพูุชโูุง
```python
# ุขูุงุฑ ุชููพูุชโูุง
def get_template_stats():
    return {
        'total_templates': WorkflowRuleTemplate.objects.count(),
        'active_templates': WorkflowRuleTemplate.objects.filter(is_active=True).count(),
        'public_templates': WorkflowRuleTemplate.objects.filter(is_public=True).count(),
        'by_organization': WorkflowRuleTemplate.objects.values('organization__name').annotate(count=Count('id'))
    }
```

### 2. ฺฏุฒุงุฑุด ููุงูู
```python
# ุขูุงุฑ ููุงูู
def get_workflow_stats(organization):
    return {
        'statuses': Status.objects.filter(is_active=True).count(),
        'actions': Action.objects.filter(is_active=True).count(),
        'transitions': Transition.objects.filter(organization=organization, is_active=True).count(),
        'post_actions': PostAction.objects.filter(is_active=True).count()
    }
```

---

## ๐ ุขูุฏู ุณุณุชู

### 1. ูฺฺฏโูุง ุขูุฏู
- ๐ **ฺฏุฑุฏุด ฺฉุงุฑ ูพูุง**: ููุงูู ูุงุจู ุชุบุฑ ุฏุฑ ุฒูุงู ุงุฌุฑุง
- ๐ค **ููุด ูุตููุน**: ูพุดููุงุฏ ููุงูู ุจููู
- ๐ฑ **ููุจุงู**: ุฑุงุจุท ููุจุงู
- ๐ **ุงุนูุงูโูุง**: ุงุนูุงูโูุง ููุดููุฏ

### 2. ุจูุจูุฏูุง ูพุดููุงุฏ
- โ **ฺฉุด**: ุจูุจูุฏ ุนููฺฉุฑุฏ ุจุง ฺฉุด
- โ **API**: API ฺฉุงูู ุจุฑุง ฺฉูพุงุฑฺูโุณุงุฒ
- โ **ูุงฺฏ**: ุณุณุชู ูุงฺฏ ูพุดุฑูุชู
- โ **ุจฺฉโุขูพ**: ุจฺฉโุขูพ ุฎูุฏฺฉุงุฑ

---

## ๐ ูพุดุชุจุงู

### 1. ุชูุงุณ ุจุง ุชู ูู
- ๐ง **ุงูู**: tech@budgetsystem.com
- ๐ **ุชููู**: 021-12345678
- ๐ฌ **ฺุช**: ุณุณุชู ฺุช ุขููุงู

### 2. ููุงุจุน ููุฏ
- ๐ **ูุณุชูุฏุงุช**: /docs/
- ๐ฅ **ูุฏููุง**: /videos/
- โ **ุณูุงูุงุช ูุชุฏุงูู**: /faq/
- ๐ **ฺฏุฒุงุฑุด ุจุงฺฏ**: /bug-report/

---

## ๐ ุชุบุฑุงุช

### ูุณุฎู 1.0.0 (2025-09-19)
- โ ุงุฌุงุฏ ุณุณุชู ฺฏุฑุฏุด ฺฉุงุฑ ูพุงู
- โ ุชููพูุช ุชุงุฏ ุฏุณุชูุฑ ูพุฑุฏุงุฎุช
- โ ุฑุงุจุท ฺฉุงุฑุจุฑ ูุฏุฑุช ุชููพูุชโูุง
- โ ุณุณุชู ุงุนูุงู ุชููพูุชโูุง

### ูุณุฎู 1.1.0 (ุขูุฏู)
- ๐ ฺฏุฑุฏุด ฺฉุงุฑ ูพูุง
- ๐ค ููุด ูุตููุน
- ๐ฑ ุฑุงุจุท ููุจุงู
- ๐ ุณุณุชู ุงุนูุงูโูุง

---

**ุชุงุฑุฎ ุขุฎุฑู ุจูโุฑูุฒุฑุณุงู**: 2025-09-19  
**ูุณุฎู**: 1.0.0  
**ููุณูุฏู**: ุชู ุชูุณุนู ุณุณุชู ุจูุฏุฌูโุจูุฏ
